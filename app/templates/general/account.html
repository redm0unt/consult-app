{% extends "base.html" %}

{% set page_description = "Управление настройками аккаунта" %}

{% block head %}
    {{ super() }}
    <link rel="stylesheet" href="{{ url_for('static', filename='style/pages/general/account.css') }}">
{% endblock %}

{% block content %}
{{ render_header(page_title, page_description) }}
<main class="content-main">
{% if invite_link %}
<section class="section" aria-label="Ссылка для родителей">
    <div class="section-header">
        <h2 class="content-subheading">Ссылка для родителей</h2>
        <div class="account-invite__wrapper">
            <a class="account-invite__link" href="{{ invite_link }}" target="_blank" rel="noopener">{{ invite_link }}</a>
            <button type="button"
                    class="account-invite__copy"
                    data-copy-text="{{ invite_link }}"
                    aria-label="Скопировать ссылку">
                <svg xmlns="http://www.w3.org/2000/svg" width="22" height="22" viewBox="0 0 16 16" fill="currentColor" role="img" aria-hidden="true">
                    <path d="M10 1.5a.5.5 0 0 1 .5-.5h3A2.5 2.5 0 0 1 16 3.5v8a2.5 2.5 0 0 1-2.5 2.5h-3A.5.5 0 0 1 10 13.5V1.5Z"/>
                    <path d="M5 4.5A2.5 2.5 0 0 1 7.5 2h3a.5.5 0 0 1 0 1h-3A1.5 1.5 0 0 0 6 4.5v8A1.5 1.5 0 0 0 7.5 14h3a.5.5 0 0 1 0 1h-3A2.5 2.5 0 0 1 5 12.5v-8Z"/>
                    <path d="M1.5 5a.5.5 0 0 0-.5.5v8A2.5 2.5 0 0 0 3.5 16h7a.5.5 0 0 0 0-1h-7A1.5 1.5 0 0 1 2 13.5v-8a.5.5 0 0 0-.5-.5Z"/>
                </svg>
                <span class="visually-hidden">Скопировать</span>
            </button>
        </div>
    </div>
</section>
{% endif %}

<form class="account-form" method="POST" action="{{ url_for('main.account') }}" novalidate>
    <div class="account-grid">
        <div class="account-grid__column">
            <section class="section">
                <div class="section-header">
                    <h2 class="content-subheading">Школа</h2>
                </div>
                <div class="input-fields-container">
                    <div class="input-fields-container__row">
                        <label class="input-fields-container__row-label" for="school_name">Название</label>
            <input id="school_name" name="school_name" type="text"
                class="input-fields-container__row-input{% if not can_manage_school %} input-fields-container__row-input--readonly{% endif %}"
                value="{{ (request.form.get('school_name') if request.method == 'POST' else (school.school_name if school else '')) or '' }}"
                                {% if not can_manage_school %}readonly{% endif %}>
                    </div>
                </div>
            </section>

            <section class="section">
                <div class="section-header">
                    <h2 class="content-subheading">Персональные данные</h2>
                </div>
                <div class="input-fields-container">
                    <div class="input-fields-container__row">
                        <label class="input-fields-container__row-label" for="last_name">Фамилия</label>
            <input id="last_name" name="last_name" type="text" class="input-fields-container__row-input"
                value="{{ (request.form.get('last_name') if request.method == 'POST' else current_user.last_name) or '' }}">
                    </div>
                    <div class="input-fields-container__row">
                        <label class="input-fields-container__row-label" for="first_name">Имя</label>
            <input id="first_name" name="first_name" type="text" class="input-fields-container__row-input"
                value="{{ (request.form.get('first_name') if request.method == 'POST' else current_user.first_name) or '' }}">
                    </div>
                    <div class="input-fields-container__row">
                        <label class="input-fields-container__row-label" for="middle_name">Отчество</label>
            <input id="middle_name" name="middle_name" type="text" class="input-fields-container__row-input"
                value="{{ (request.form.get('middle_name') if request.method == 'POST' else current_user.middle_name) or '' }}">
                    </div>
                </div>
            </section>
        </div>

        <div class="account-grid__column">
            <section class="section">
                <div class="section-header">
                    <h2 class="content-subheading">Авторизация</h2>
                </div>
                <div class="input-fields-container">
                    <div class="input-fields-container__row">
                        <label class="input-fields-container__row-label" for="email">Электронная почта</label>
            <input id="email" name="email" type="email"
                class="input-fields-container__row-input"
                value="{{ (request.form.get('email') if request.method == 'POST' else current_user.email) or '' }}">
                    </div>
                </div>
            </section>

            <section class="section">
                <div class="section-header">
                    <h2 class="content-subheading">Смена пароля</h2>
                </div>
                <div class="input-fields-container">
                    <div class="input-fields-container__row">
                        <label class="input-fields-container__row-label" for="password_old">Старый пароль</label>
                        <input id="password_old" name="password_old" type="password" class="input-fields-container__row-input" placeholder="••••••••">
                    </div>
                    <div class="input-fields-container__row">
                        <label class="input-fields-container__row-label" for="password_new">Новый пароль</label>
                        <input id="password_new" name="password_new" type="password" class="input-fields-container__row-input" placeholder="••••••••">
                    </div>
                </div>
            </section>
        </div>
    </div>

    <div class="account-form__actions">
        <button type="submit" class="button main-button shadowed-button larger-button">Применить</button>
    </div>
</form>
</main>
{% endblock %}
